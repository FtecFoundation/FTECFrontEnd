<app-preloader class="behavioral--preloader-main" *ngIf="globalPreloader"></app-preloader>

<div class="main-info main-info--behavioral" *ngIf="!globalPreloader">
    <div class="middle middle--behavioral">

        <div class="middle__head middle__head--behavioral">Trading reports</div>

        <div *ngIf="!responseData || this.responseData.operations['All'].length == 0" class="item-inner-line-error-block item-inner-line-error-block--empty">
            You have no analyses results yet. Please, use form to start some analise.
        </div>

        <div class="middle__block middle__block--behavioral" *ngIf="responseData && responseData.operations[chosenStatistics]">

            <div class="behavioral__small-container-inner" *ngFor="let item of responseData.operations[chosenStatistics]">
                <div class="behavioral__small-container">
                    <div class="small-container__line">
                        <h2>{{item.pair}}</h2>

                        <a href="javascrip:void(0)" class="small-container__line-link">{{item.operationType}}</a>
                    </div>

                    <div class="small-container__line small-container__line--button">
                        <div class="small-container__subtext">
                            <span class="text-small">{{item.stock}}</span>
                            <span class="text-small">{{item.closingDate | date:'yyyy-MM-dd HH:mm:ss'}}</span>
                        </div>

                        <div class="small-container__graph" [ngClass]="{'is-active' : item.chosen}">
                            <span>Charts will be available in next update!</span>
                            <!-- CHARTS -->

                            <ngx-charts-line-chart [scheme]="lineChartColorScheme" [results]="data" [xAxis]="lineChartShowXAxis" [yAxis]="lineChartShowYAxis"
                            [legend]="lineChartShowLegend" [rangeFillOpacity]="0.2" [schemeType]="schemeType" [showXAxisLabel]="lineChartShowXAxisLabel"
                            [showYAxisLabel]="lineChartShowYAxisLabel" [showGridLines]="showGridLines" [autoScale]="lineChartAutoScale"
                            [curve]="lineChartLineInterpolation" [tooltipDisabled]="tooltipDisabled" [showRefLines]="showRefLines"
                            [showRefLabels]="showRefLabels" [referenceLines]="refLines" (select)="onSelect($event)">
                            </ngx-charts-line-chart>

                            <div class="small-container__graph-controls">
                           <span class="graph-controls__item graph-controls__item--red">You</span>
                            <span class="graph-controls__item graph-controls__item--blue">Recommended</span>
                            </div>
                        </div>

                        <button class="filter__container-button filter__container-button--behavioral is-active" (click)="showFull(item)">Full report
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!--<div class="small-container__graph-controls">-->
        <!--<span class="graph-controls__item graph-controls__item&#45;&#45;red">You</span>-->
        <!--<span class="graph-controls__item graph-controls__item&#45;&#45;blue">Recommended</span>-->
        <!--</div>-->
    </div>


    <div class="aside-right aside-right--behavioral">
        <div class="aside-right__head aside-right__head--behavioral">Statistics & charts shown for stock:

            <div class="container__form container__form--select container__form--behavioral">
                <app-dropdown [label]="'Choose stock'" [active]="'All'" [items]="availableStocks" (selected)="onSelect($event)"></app-dropdown>
            </div>
        </div>

        <div class="aside-right__filter aside-right__filter--behavioral" *ngIf="responseData && responseData.statistics">

            <div class="behavioral__block" *ngIf="!requestPreloader">
                <div class="behavioral__stats">
                    <span class="text-small">Forecasts accuracy</span>

                    <span class="behavioral__stats-num">{{responseData.statistics[chosenStatistics].accuracy | number:'1.2-4'}}</span>
                </div>
                <div class="behavioral__stats">
                    <span class="text-small">Potential loss of profit</span>

                    <span class="behavioral__stats-num">{{responseData.statistics[chosenStatistics].profitLoss | number:'1.2-4'}}</span>
                </div>
                <div class="behavioral__stats">
                    <span class="text-small">Panic buy</span>

                    <span class="behavioral__stats-num">{{responseData.statistics[chosenStatistics].panicBuy}}</span>
                </div>
                <div class="behavioral__stats">
                    <span class="text-small">Panic sell</span>

                    <span class="behavioral__stats-num">{{responseData.statistics[chosenStatistics].panicSell}}</span>
                </div>

                <div class="behavioral__stats">
                    <span class="text-small">Successful orders</span>

                    <span class="behavioral__stats-num">{{responseData.statistics[chosenStatistics].successfulOrders}}</span>
                </div>
                <div class="behavioral__stats">
                    <span class="text-small">Failed orders</span>

                    <span class="behavioral__stats-num">{{responseData.statistics[chosenStatistics].failedOrders}}</span>
                </div>
            </div>

            <app-preloader *ngIf="requestPreloader"></app-preloader>
            <span>{{errorText}}</span>

            <div class="container__form--behavioral-select" *ngIf="!requestPreloader">
                <h4 *ngIf="!stockToSend" class="container__form-warning">To request new analysis please choose the stock!</h4>
                <div class="container__form container__form--select container__form--behavioral-select">
                    <app-dropdown [label]="'Choose exchange to search'" [items]="installedStocks" (selected)="setStockToSend($event)" [keyName]="'name'"></app-dropdown>
                </div>

                <button class="filter__container-button" (click)="sendRequest()" [disabled]="!stockSelected">Get stats</button>
            </div>
        </div>

        <!-- <div class="aside-right__filter aside-right__filter--behavioral aside-right__filter--bottom" *ngIf="responseData && responseData.statistics">
            <p class="behavioral--text--red">You are a very nervous trader. In 85% of cases, you get out of trades too early. Try to set your Take-Profit
                level 2% higher than usual.</p>
        </div> -->

        <div class="filter__container filter__container--notifications filter__container--behavioral" *ngIf="!responseData || this.responseData.operations['All'].length == 0">
            <p>To get started you need to connect the API keys on the 'my-exchanges' page. You can proceed </p><a href="/account/my-exchanges"> here</a>
        </div>

</div>

</div>